generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Property {
  id              String   @id @default(cuid())
  address         String   @unique
  zpid            String?
  streetAddress   String?
  city            String?
  state           String?
  zipcode         String?
  bedrooms        Int?
  bathrooms       Float?
  livingArea      Int?
  yearBuilt       Int?
  homeType        String?
  price           Float?
  zestimate       Float?
  priceHistory    Json?
  zestimateHistory Json?
  rawData         Json?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  tags            PropertyTag[]
  motivations     PropertyMotivation[]
  statuses        PropertyStatus[]
}

model Tag {
  id        String   @id @default(cuid())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  properties PropertyTag[]
}

model Motivation {
  id        String   @id @default(cuid())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  properties PropertyMotivation[]
}

model PropertyTag {
  id         String   @id @default(cuid())
  property   Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  propertyId String
  tag        Tag      @relation(fields: [tagId], references: [id], onDelete: Restrict)
  tagId      String
  createdAt  DateTime @default(now())

  @@unique([propertyId, tagId])
}

model PropertyMotivation {
  id           String     @id @default(cuid())
  property     Property   @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  propertyId   String
  motivation   Motivation @relation(fields: [motivationId], references: [id], onDelete: Restrict)
  motivationId String
  createdAt    DateTime   @default(now())

  @@unique([propertyId, motivationId])
}

model Status {
  id         String   @id @default(cuid())
  name       String   @unique
  color      String
  isDefault  Boolean  @default(false)
  isActive   Boolean  @default(true)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  properties PropertyStatus[]
}

model PropertyStatus {
  id         String   @id @default(cuid())
  property   Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  propertyId String
  status     Status   @relation(fields: [statusId], references: [id], onDelete: Restrict)
  statusId   String
  createdAt  DateTime @default(now())

  @@unique([propertyId, statusId])
}
